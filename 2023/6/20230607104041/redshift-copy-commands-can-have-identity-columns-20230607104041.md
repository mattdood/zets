---
path: '/2023/6/redshift-copy-commands-can-have-identity-columns-20230607104041'
title: 'redshift COPY commands can have identity columns'
date: '20230607104041'
category: 'databases'
tags: ['redshift', 'etl', 'dba']
---

# redshift COPY commands can have identity columns
Recently I learned that `COPY` commandsd can have a flag called `EXPLICIT_IDS` when
working with Redshift. This allows identity based insert operations to occur,
which is helpful for ingest jobs.

Additionally, the flag can be passed for tables that **do not** have an identity column,
which will still operate just fine. This is great for if we have lots of tables that
we're doing `COPY` operations on, but don't want to specifically do some backend logic
to handle which ones need identity based checking explicitly.

The "laziness" factor of this seems to be beneficial for bulk operations.

## References
- [`COPY` documentation](https://docs.aws.amazon.com/redshift/latest/dg/r_COPY.html#r_COPY-syntax)
- [`EXPLICIT_IDS` documentation](https://docs.aws.amazon.com/redshift/latest/dg/copy-parameters-data-conversion.html#copy-explicit-ids)
- [`COPY` command column mapping documentation](https://docs.aws.amazon.com/redshift/latest/dg/copy-parameters-column-mapping.html) - The important bits are below.
    - If an `IDENTITY` column is included in the column list, then `EXPLICIT_IDS` must also be specified; if
    an `IDENTITY` column is omitted, then `EXPLICIT_IDS` can't be specified. If no column list is specified,
    the command behaves as if a complete, in-order column list was specified, with `IDENTITY` columns omitted if `EXPLICIT_IDS`
    was also not specified.
    - If a column is defined with `GENERATED BY DEFAULT AS IDENTITY`, then it can be copied.
    Values are generated or updated with values that you supply. The `EXPLICIT_IDS` option isn't required.
    `COPY` doesn't update the identity high watermark. For more information, see `GENERATED BY DEFAULT AS IDENTITY`.
